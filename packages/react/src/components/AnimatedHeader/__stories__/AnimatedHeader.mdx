import { ArgTypes, Canvas, Meta } from '@storybook/addon-docs/blocks';
import * as AnimatedHeaderStories from './AnimatedHeader.stories';
import AnimatedHeader from '../components/AnimatedHeader/AnimatedHeader';

<Meta isTemplate />

# Animated Header

- **Initiative owner(s):** Drew Glapa
- **Status:** Draft
- **Target library:** TBD
- **Target library maintainer(s) / PR Reviewer(s):** N/A
- **Support channel:** `#carbon-labs`

{/* <!-- START doctoc generated TOC please keep comment here to allow auto update --> */}
{/* <!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE --> */}

> üí° Check our
> [Stackblitz](https://stackblitz.com/github/carbon-design-system/carbon-labs/tree/main/examples/react/AnimatedHeader)
> example implementation.

[![Edit carbon-labs](https://developer.stackblitz.com/img/open_in_stackblitz.svg)](https://stackblitz.com/github/carbon-design-system/carbon-labs/tree/main/examples/react/AnimatedHeader)

## Table of Contents

- [Overview](#overview)
  - [Anatomy](#anatomy)
  - [Theming](#theming)
  - [Tile Configuration](#tile-configuration)
    - [New `variant` Prop](#new-variant-prop)
    - [Required `tileId`](#required-tileid)
    - [Canonical Icon Props](#canonical-icon-props)
    - [Variant-specific Props](#variant-specific-props)
      - [GlassTile (`variant: 'glass'`)](#glasstile-variant-glass)
      - [AITile (`variant: 'ai'`)](#aitile-variant-ai)
      - [AIPromptTile (`variant: 'aiPrompt'`)](#aiprompttile-variant-aiprompt)
    - [Migration Guide](#migration-guide)
  - [Tasks Controller](#tasks-controller)
    - [Button](#button)
    - [Dropdown](#dropdown)
  - [Content Switcher](#content-switcher)
  - [Header Action](#header-action)
    - [Icon Button](#icon-button)
    - [Ghost Button](#ghost-button)
    - [Carousel (coming soon)](#carousel-coming-soon)
  - [Accessibility](#accessibility)
    - [Tile ARIA Labels](#tile-aria-labels)
    - [Tasks Dropdown ARIA Label](#tasks-dropdown-aria-label)
    - [Content Switcher ARIA Label](#content-switcher-aria-label)
    - [Workspace Selector ARIA Label](#workspace-selector-aria-label)
    - [Header Action ARIA Label](#header-action-aria-label)
    - [Additional ARIA Labels](#additional-aria-labels)
- [Getting started](#getting-started)
  - [JS (via import)](#js-via-import)
  - [SCSS](#scss)
- [Component API](#component-api)
- [Example usages](#example-usages)

{/* <!-- END doctoc generated TOC please keep comment here to allow auto update --> */}

## Overview

The animated header is meant to be used on homepages only. It ensures
consistency throughout landing experiences, providing a cohesive appearance and
clear call to action for users. The skeleton for this header component ensures
consistency while flexible page elements allow teams to tailor the leadspace to
their individual user and product needs.

Lead spaces include a welcome text, a short description communicating the
product‚Äôs value proposition and feature most relevant content for the user.
Whether these are links to specific tasks, workspaces or other information is
defined by each product and their user‚Äôs needs. In-product imagery has to be
very subtle to not distract users from performing their tasks.

<Canvas
  of={AnimatedHeaderStories.ThemeG10}
  additionalActions={[
    {
      title: 'Open in Stackblitz',
      onClick: () => stackblitzPrefillConfig(AnimatedHeaderStories.ThemeG10),
    },
  ]}
/>

### Anatomy

**Title:** Welcomes the user (Welcome, username)

**Content:** Short sentence in max. 3 lines related to product context; Action
button (optional). It is recommended to display content on cards to achieve
highest contrast to the background.

**Visual / brand image:** Line-style illustration (Lottie or static)

**Collapse / Expand:** Icon to collapse or expand the header

**Tasks Controller placement:**

- **Dropdown / Button** render in the **left column** under the description.

**Content Switcher placement:**

- Renders **inline in the title row**, aligned to the right of ‚ÄúWelcome,
  {`user`} on medium+ viewports (default styles). You can override placement
  with custom styles if needed.

**Header Action placement:**

- Renders **inline in the bottom-right action row**, immediately to the **left**
  of the **Collapse** button.
- Always shows a subtle vertical divider between it and preceding actions.
- Supports multiple presentations (see below).

---

### Theming

The default theme for Animated Header is _g10_ (Light theme).

Animated header supports both _g10_ (Light theme) and _g100_ (Dark Theme).

To use dark theme in your product/app wrap the component in the Carbon
[GlobalTheme](https://react.carbondesignsystem.com/?path=/docs/components-theme--overview#setting-the-global-theme)
component. Following the example from the Carbon website it would look like
this:

```jsx
import { useEffect } from 'react';
import { GlobalTheme } from '@carbon/react';

function App() {
  const theme = 'g100'; // ‚Üê your implementation, e.g. fetching user settings

  useEffect(() => {
    document.documentElement.dataset.carbonTheme = theme;
  }, [theme]);

  return (
    <GlobalTheme theme={theme}>
      <AnimatedHeader />
    </GlobalTheme>
  );
}
```

---

### Tile Configuration

The **AnimatedHeader** renders groups of `Tile`s via the `BaseTile` router. Each
tile must define a `variant` to specify which tile component should render.

#### New `variant` Prop

- **Required** to select the tile type.
- Supported values: `'glass'`, `'aiPrompt'`, `'ai'`.
- `glass` remains the default if no variant is specified.

```diff
- { id: 'ai-tile', mainIcon: Term } // old way to get AIPromptTile
+ { tileId: 'tile-1', variant: 'aiPrompt', primaryIcon: Term } // ‚úÖ new way
```

‚ö†Ô∏è **Back-compat:** The legacy `id: 'ai-tile'` is still supported but will be
removed in a future release. Migrate to using `variant`.

#### Required `tileId`

Every tile **must define a `tileId`**. This provides both:

- A stable React `key`
- The identifier passed to the child tile component

‚ö†Ô∏è **Deprecated:** The old `id` prop is still accepted for legacy builds, but
should be replaced with `tileId`.

```jsx
{
  tileId: 'tile-1',
  variant: 'glass',
  title: 'Load data',
  primaryIcon: DataSet,
  ariaLabel: 'Load data using Data explorer',
}
```

#### Canonical Icon Props

Use `primaryIcon` (leading icon) and `secondaryIcon` (optional trailing icon).

‚ö†Ô∏è **Deprecated:** The older `mainIcon` prop is still supported via a BaseTile
fallback but should be replaced.

```jsx
{
  tileId: 'tile-2',
  variant: 'glass',
  title: 'Export data',
  primaryIcon: Export,
  secondaryIcon: ArrowRight,
}
```

#### Variant-specific Props

##### GlassTile (`variant: 'glass'`)

| Prop                | Type                          | Notes                                              |
| ------------------- | ----------------------------- | -------------------------------------------------- |
| `tileId`            | `string \| null`              | Identifier (recommended non-null in configs).      |
| `href`              | `string \| null`              | Link target; omit for non-interactive tile.        |
| `title`             | `string \| ReactNode \| null` | Title text.                                        |
| `subtitle`          | `string \| ReactNode \| null` | Secondary line.                                    |
| `disabledTaskLabel` | `string \| null`              | Tooltip/label shown when disabled.                 |
| `customContent`     | `ReactNode \| null`           | Custom body content instead of default.            |
| `primaryIcon`       | `ElementType \| null`         | Leading icon component.                            |
| `secondaryIcon`     | `ElementType \| null`         | Optional trailing icon component.                  |
| `tagLabel`          | `string \| null`              | Optional read-only tag text in the upper-right.    |
| `tagType`           | `TagProps<'div'>['type']`     | Carbon `Tag` color token (for example, `blue`).    |
| `onClick`           | `(() => void) \| null`        | Click handler for interactive tiles.               |
| `ariaLabel`         | `string`                      | Accessibility label (required for a11y).           |
| `isLoading`         | `boolean`                     | Shows skeleton state.                              |
| `isDisabled`        | `boolean`                     | Disables interactions and applies disabled styles. |

##### AITile (`variant: 'ai'`)

| Prop                | Type                          | Notes                                              |
| ------------------- | ----------------------------- | -------------------------------------------------- |
| `tileId`            | `string \| null`              | Identifier (recommended non-null in configs).      |
| `href`              | `string \| null`              | Link target; omit for non-interactive tile.        |
| `title`             | `string \| ReactNode \| null` | Title text.                                        |
| `subtitle`          | `string \| ReactNode \| null` | Secondary line.                                    |
| `disabledTaskLabel` | `string \| null`              | Tooltip/label shown when disabled.                 |
| `customContent`     | `ReactNode \| null`           | Custom body content instead of default.            |
| `primaryIcon`       | `ElementType \| null`         | Leading icon component.                            |
| `secondaryIcon`     | `ElementType \| null`         | Optional trailing icon component.                  |
| `aiLabelVariant`    | `'aiLabel' \| 'tag'`          | Choose Carbon `AILabel` (default) or `Tag`.        |
| `aiLabelText`       | `string`                      | Text for the AI label or tag (defaults to `AI`).   |
| `aiLabelTagType`    | `TagProps<'div'>['type']`     | Tag color when `aiLabelVariant` is `tag`.          |
| `onClick`           | `(() => void) \| null`        | Click handler for interactive tiles.               |
| `ariaLabel`         | `string`                      | Accessibility label (required for a11y).           |
| `isLoading`         | `boolean`                     | Shows skeleton state.                              |
| `isDisabled`        | `boolean`                     | Disables interactions and applies disabled styles. |

##### AIPromptTile (`variant: 'aiPrompt'`)

| Prop                | Type                          | Notes                                                 |
| ------------------- | ----------------------------- | ----------------------------------------------------- |
| `tileId`            | `string \| null`              | Identifier (recommended non-null in configs).         |
| `href`              | `string \| null`              | Destination for ‚ÄúOpen [product]‚Äù.                     |
| `title`             | `string \| ReactNode \| null` | Heading text.                                         |
| `disabledTaskLabel` | `string \| null`              | Tooltip/label shown when disabled.                    |
| `productName`       | `string`                      | Used in labels (e.g., ‚ÄúOpen [product]‚Äù, button text). |
| `promptPlaceholder` | `string`                      | Placeholder for the chat input.                       |
| `primaryIcon`       | `ElementType \| null`         | Leading icon component.                               |
| `aiLabelVariant`    | `'aiLabel' \| 'tag'`          | Choose Carbon `AILabel` (default) or `Tag`.           |
| `aiLabelText`       | `string`                      | Text for the AI label or tag (defaults to `AI`).      |
| `aiLabelTagType`    | `TagProps<'div'>['type']`     | Tag color when `aiLabelVariant` is `tag`.             |
| `onClick`           | `(() => void) \| null`        | Click handler for interactive tiles.                  |
| `ariaLabel`         | `string`                      | Accessibility label (required for a11y).              |
| `isLoading`         | `boolean`                     | Shows skeleton state.                                 |
| `isDisabled`        | `boolean`                     | Disables interactions and applies disabled styles.    |

> Note: AIPromptTile handles text input internally and can optionally call your
> `onSubmit` in your product integration (if you wire it), but the core public
> props above are what's typically used in `AnimatedHeader`.

---

#### Migration Guide

- Replace `id` ‚Üí `tileId`
- Replace `mainIcon` ‚Üí `primaryIcon`
- Use `variant` to explicitly pick the tile type
- Ensure every tile defines `tileId`
- Add `ariaLabel` to every tile for accessibility

Example migration:

```diff
- {
-   id: 'ai-tile',
-   title: 'Short description of the type of prompt',
-   mainIcon: Term
- }
+ {
+   tileId: 'tile-1',
+   variant: 'aiPrompt',
+   title: 'Short description of the type of prompt',
+   primaryIcon: Term
+ }
```

---

### Tasks Controller

The Tasks Controller appears in the header to help users quickly switch
contexts. You can render it as a **Button** or a **Dropdown**.

> **Placement**
>
> - **Dropdown / Button**: left column under the description.

#### Button

```tsx
export const tasksControllerConfigButton = {
  type: 'button',
  button: {
    text: 'Get started',
    href: 'https://www.ibm.com',
    icon: Add,
  },
};
```

#### Dropdown

```tsx
export const tasksControllerConfigDropdown = {
  type: 'dropdown',
  dropdown: {
    label: 'Customize your journey',
    allTileGroups: headerTiles,
    selectedTileGroup: headerTiles[0],
    setSelectedTileGroup: (group) => {
      // Updates which tiles render in the header
      // (Your app likely stores this in state)
    },
    ariaLabel: 'Select a task group',
  },
};
```

---

### Content Switcher

The **Content Switcher** renders **2 or 3** segments and is placed in the top
title row on medium+ viewports.

- `visibleCount`: **2 or 3** (defaults to 2).
- `lowContrast`: **boolean** ‚Äî toggles Carbon‚Äôs low-contrast visual style for
  the switcher.
- Provide exactly **2 or 3** `items`. If fewer than 2 are available, it won‚Äôt
  render.
- Use `onSelect` per item to update the active `selectedTileGroup` in your app.

```tsx
const contentSwitcherConfig = {
  ariaLabel: 'Content switcher actions',
  visibleCount: 2,
  lowContrast: true,
  selectedIndex: 0, // optional; defaults to 0 (safe-bounded)
  items: [
    {
      id: 'opt-0',
      text: headerTiles[0].label,
      onSelect: () => setSelectedTileGroup(headerTiles[0]),
    },
    {
      id: 'opt-1',
      text: headerTiles[1].label,
      onSelect: () => setSelectedTileGroup(headerTiles[1]),
    },
  ],
};
```

> In Storybook, use the **‚ÄúContent Switcher Low Contrast‚Äù** toggle to set this
> at runtime. This toggles the `lowContrast` property inside your
> `contentSwitcherConfig` selection.

---

### Header Action

The Header Action is a small control that appears to the **left of the Collapse
button** in the bottom action row. It‚Äôs meant for quick access patterns like a
**settings icon** or a **‚ÄúView all‚Äù ghost button**. A **Carousel pager** is
planned to page through multiple tile views (see ‚Äúcoming soon‚Äù).

> **Divider:** A subtle vertical divider is always shown to the left of the
> header action to separate it from other actions.

#### Icon Button

Use any Carbon icon component (from `@carbon/icons-react`) and an accessible
label.

```tsx
import { Settings } from '@carbon/icons-react';

export const headerActionIconConfig = {
  type: 'icon-button',
  icon: Settings, // component type (ElementType)
  iconLabel: 'Open controls',
  onClick: () => openControlsModal(),
};
```

#### Ghost Button

Provide a label and (optionally) a trailing icon component. This is ideal for
‚ÄúView all‚Äù patterns that open a modal listing all tiles.

```tsx
import { ArrowRight } from '@carbon/icons-react';

export const headerActionGhostConfig = {
  type: 'ghost-button',
  label: 'View all',
  icon: ArrowRight, // optional
  onClick: () => openAllTilesModal(),
};
```

#### Carousel (coming soon)

A compact pager that switches between **pages of tiles**. This feature will ship
in a future release.

```tsx
// COMING SOON
export const headerActionCarouselConfig = {
  type: 'carousel',
  page: 0,
  total: 3,
  onSelectPage: (p) => setPage(p),
  onStep: (direction, next) => analytics('pager-step', { direction, next }),
};
```

---

### Accessibility

To ensure a fully accessible experience, provide `aria-label`s directly in your
tile and configuration data.

#### Tile ARIA Labels

Each `Tile` must define an `ariaLabel` property directly within its data object.

```jsx
import { type TileGroup } from '@carbon-labs/react-animated-header';

export const headerTiles: TileGroup[] = [
  {
    id: 1,
    label: 'AI Prompt Tile w/ two glass tiles',
    tiles: [
      {
        tileId: 'tile-1',
        variant: 'aiPrompt',
        href: '#',
        title: 'Short description of the type of prompt',
        primaryIcon: Term,
        ariaLabel: 'Start a conversation with the AI assistant', // ‚úÖ aria-label defined here
        aiLabelVariant: 'tag',
        aiLabelTagType: 'gray',
      },
    ],
  },
] satisfies TileGroup[];
```

#### Tasks Dropdown ARIA Label

For the tasks controller dropdown, provide the `ariaLabel` directly in the
config object:

```jsx
export const tasksControllerConfigDropdown = {
  type: 'dropdown',
  dropdown: {
    label: 'Customize your journey',
    allTileGroups: headerTiles,
    selectedTileGroup: headerTiles[0],
    setSelectedTileGroup: () => {},
    ariaLabel: 'Select a task group', // ‚úÖ aria-label defined here
  },
};
```

#### Content Switcher ARIA Label

```jsx
export const contentSwitcherConfig = {
  ariaLabel: 'Content switcher actions', // ‚úÖ aria-label defined here
  visibleCount: 2,
  lowContrast: true,
  items: [
    {
      id: 'opt-0',
      text: headerTiles[0].label,
      onSelect: () => setSelectedTileGroup(headerTiles[0]),
    },
    {
      id: 'opt-1',
      text: headerTiles[1].label,
      onSelect: () => setSelectedTileGroup(headerTiles[1]),
    },
  ],
};
```

#### Workspace Selector ARIA Label

For the workspace selector, define the `ariaLabel` at the top level of the
config object:

```jsx
export const workspaceSelectorConfig = {
  allWorkspaces: workspaceData,
  setSelectedWorkspace: () => {},
  propsOverrides: {
    label: 'Select workspace',
    renderSelectedItem: (item) => `Open in: ${item.label}`,
  },
  ariaLabel: 'Select a workspace', // ‚úÖ aria-label defined here
};
```

#### Header Action ARIA Label

Each header action variant also accepts an optional `ariaLabel`. Use it if the
visual label isn‚Äôt descriptive enough (e.g., when using only an icon).

```tsx
export const headerActionIconConfig = {
  type: 'icon-button',
  icon: Settings,
  iconLabel: 'Open header controls',
  ariaLabel: 'Open header controls', // ‚úÖ aria-label defined here
  onClick: () => openControlsModal(),
};
```

> ‚úÖ Both the **tasks dropdown** and **workspace selector** must define their
> `aria-label` values in the config to support accessibility. No other methods
> of passing `aria-label`s are supported.

---

#### Additional ARIA Labels

Set all other component-level `aria-label`s using the `ariaLabels` prop:

```jsx
const ariaLabels = {
  welcome: 'Welcomes the user',
  description: 'Short description of the product',
  collapseButton: 'Collapse header details',
  expandButton: 'Expand header details',
  tilesContainer: 'Feature tiles list',
};
```

These labels are applied to non-tile UI elements such as headers, containers,
and interactive buttons.

## Getting started

Here's a quick example to get you started.

```bash
yarn add @carbon/react
yarn add @carbon-labs/react-animated-header
```

### JS (via import)

```jsx
import { AnimatedHeader } from '@carbon-labs/react-animated-header';

function App() {
  return <AnimatedHeader />;
}

export default App;
```

### SCSS

In your styles file import

```scss
@use '@carbon/react';
@use '@carbon-labs/react-animated-header/scss/animated-header';
```

## Component API

<ArgTypes />

## Example usages

Example of Animated Header with all prop types enabled.

```jsx
<AnimatedHeader
  productName="[Product name]"
  description="Connect, monitor, and manage data."
  welcomeText="Welcome"
  userName="Drew"
  ariaLabels={ariaLabels as AriaLabels}
  headerAnimation={watsonXAnimatedLight}
  headerStatic={watsonXStaticLight}
  allTileGroups={tiles}
  selectedTileGroup={selectedTile}
  workspaceSelectorConfig={workspaceSelectorConfig}
  tasksControllerConfig={tasksControllerConfigDropdown as TasksControllerConfig}
  contentSwitcherConfig={contentSwitcherConfig}
  headerActionConfig={headerActionGhostConfig}
  isLoading={false}
  tileClickHandler={handleTileClicks}
/>
```
