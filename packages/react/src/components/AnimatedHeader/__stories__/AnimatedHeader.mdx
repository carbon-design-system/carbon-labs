import { ArgTypes, Canvas, Meta } from '@storybook/addon-docs/blocks';
import * as AnimatedHeaderStories from './AnimatedHeader.stories';
import AnimatedHeader from '../components/AnimatedHeader/AnimatedHeader';

<Meta isTemplate />

# Animated Header

- **Initiative owner(s):** Drew Glapa
- **Status:** Draft
- **Target library:** TBD
- **Target library maintainer(s) / PR Reviewer(s):** N/A
- **Support channel:** `#carbon-labs`

{/* <!-- START doctoc generated TOC please keep comment here to allow auto update --> */}
{/* <!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE --> */}

> üí° Check our
> [Stackblitz](https://stackblitz.com/github/carbon-design-system/carbon-labs/tree/main/examples/react/AnimatedHeader)
> example implementation.

[![Edit carbon-labs](https://developer.stackblitz.com/img/open_in_stackblitz.svg)](https://stackblitz.com/github/carbon-design-system/carbon-labs/tree/main/examples/react/AnimatedHeader)

## Table of Contents

- [Overview](#overview)
  - [Anatomy](#anatomy)
  - [Theming](#theming)
  - [Tile Configuration](#tile-configuration)
    - [New `variant` Prop](#new-variant-prop)
    - [Required `tileId`](#required-tileid)
    - [Canonical Icon Props](#canonical-icon-props)
    - [Variant-specific Props](#variant-specific-props)
      - [GlassTile (`variant: 'glass'`)](#glasstile-variant-glass)
      - [AITile (`variant: 'ai'`)](#aitile-variant-ai)
      - [AIPromptTile (`variant: 'aiPrompt'`)](#aiprompttile-variant-aiprompt)
    - [Migration Guide](#migration-guide)
  - [Accessibility](#accessibility)
    - [Tile ARIA Labels](#tile-aria-labels)
    - [Tasks Dropdown ARIA Label](#tasks-dropdown-aria-label)
    - [Workspace Selector ARIA Label](#workspace-selector-aria-label)
    - [Additional ARIA Labels](#additional-aria-labels)
- [Getting started](#getting-started)
  - [JS (via import)](#js-via-import)
  - [SCSS](#scss)
- [Component API](#component-api)
- [Example usages](#example-usages)

{/* <!-- END doctoc generated TOC please keep comment here to allow auto update --> */}

## Overview

The animated header is meant to be used on homepages only. It ensures
consistency throughout landing experiences, providing a cohesive appearance and
clear call to action for users. The skeleton for this header component ensures
consistency while flexible page elements allow teams to tailor the leadspace to
their individual user and product needs.

Lead spaces include a welcome text, a short description communicating the
products value proposition and feature most relevant content for the user.
Whether these are links to specific tasks, workspaces or other information is
defined by each product and their user‚Äôs needs. In product-imagery has to be
very settled and subtil to not distract users in performing their tasks.

<Canvas
  of={AnimatedHeaderStories.ThemeG10}
  additionalActions={[
    {
      title: 'Open in Stackblitz',
      onClick: () => stackblitzPrefillConfig(AnimatedHeaderStories.ThemeG10),
    },
  ]}
/>

### Anatomy

**Title:** Welcomes the user (Welcome, username)

**Content:** Short sentence in max. 3 lines related to product context; Action
button (optional), Expose content that need highest attention from the user or
content that trigger an action and allow users to directly start working and
gain value (within one click). It is recommended to display content on cards to
achieve highest contrast to the background.

**Visual / brand image:** Line-style illustration

**Collapse / Expand:** Icon to collapse or expand the header

---

### Theming

The default theme for Animated Header is _g10_ (Light theme).

Animated header supports both _g10_ (Light theme) and _g100_ (Dark Theme).

To use dark theme in your product/app wrap the componenet in the Carbon
[GlobalTheme](https://react.carbondesignsystem.com/?path=/docs/components-theme--overview#setting-the-global-theme)
component. Following the example from the Carbon website it would like this:

```jsx
import { useEffect } from 'react';
import { GlobalTheme } from '@carbon/react';

function App() {
  const theme = 'g100'; // ‚Üê your implementation, e.g. fetching user settings

  useEffect(() => {
    document.documentElement.dataset.carbonTheme = theme;
  }, [theme]);

  return (
    <GlobalTheme theme={theme}>
      <AnimatedHeader />
    </GlobalTheme>;
  );
}
```

---

### Tile Configuration

The **AnimatedHeader** renders groups of `Tile`s via the `BaseTile` router. Each
tile must define a `variant` to specify which tile component should render.

#### New `variant` Prop

- **Required** to select the tile type.
- Supported values: `'glass'`, `'aiPrompt'`, `'ai'`.
- `glass` remains the default if no variant is specified.

```diff
- { id: 'ai-tile', mainIcon: Term } // old way to get AIPromptTile
+ { tileId: 'tile-1', variant: 'aiPrompt', primaryIcon: Term } // ‚úÖ new way
```

‚ö†Ô∏è **Back-compat:** The legacy `id: 'ai-tile'` is still supported but will be
removed in a future release. Migrate to using `variant`.

#### Required `tileId`

Every tile **must define a `tileId`**. This provides both:

- A stable React `key`
- The identifier passed to the child tile component

‚ö†Ô∏è **Deprecated:** The old `id` prop is still accepted for legacy builds, but
should be replaced with `tileId`.

```jsx
{
  tileId: 'tile-1',
  variant: 'glass',
  title: 'Load data',
  primaryIcon: DataSet,
  ariaLabel: 'Load data using Data explorer',
}
```

#### Canonical Icon Props

Use `primaryIcon` (leading icon) and `secondaryIcon` (optional trailing icon).

‚ö†Ô∏è **Deprecated:** The older `mainIcon` prop is still supported via a BaseTile
fallback but should be replaced.

```jsx
{
  tileId: 'tile-2',
  variant: 'glass',
  title: 'Export data',
  primaryIcon: Export,
  secondaryIcon: ArrowRight,
}
```

#### Variant-specific Props

##### GlassTile (`variant: 'glass'`)

| Prop                | Type                          | Notes                                              |
| ------------------- | ----------------------------- | -------------------------------------------------- |
| `tileId`            | `string \| null`              | Identifier (recommended non-null in configs).      |
| `href`              | `string \| null`              | Link target; omit for non-interactive tile.        |
| `title`             | `string \| ReactNode \| null` | Title text.                                        |
| `subtitle`          | `string \| ReactNode \| null` | Secondary line.                                    |
| `disabledTaskLabel` | `string \| null`              | Tooltip/label shown when disabled.                 |
| `customContent`     | `ReactNode \| null`           | Custom body content instead of default.            |
| `primaryIcon`       | `ElementType \| null`         | Leading icon component.                            |
| `secondaryIcon`     | `ElementType \| null`         | Optional trailing icon component.                  |
| `onClick`           | `(() => void) \| null`        | Click handler for interactive tiles.               |
| `ariaLabel`         | `string`                      | Accessibility label (required for a11y).           |
| `isLoading`         | `boolean`                     | Shows skeleton state.                              |
| `isDisabled`        | `boolean`                     | Disables interactions and applies disabled styles. |

##### AITile (`variant: 'ai'`)

| Prop                | Type                          | Notes                                              |
| ------------------- | ----------------------------- | -------------------------------------------------- |
| `tileId`            | `string \| null`              | Identifier (recommended non-null in configs).      |
| `href`              | `string \| null`              | Link target; omit for non-interactive tile.        |
| `title`             | `string \| ReactNode \| null` | Title text.                                        |
| `subtitle`          | `string \| ReactNode \| null` | Secondary line.                                    |
| `disabledTaskLabel` | `string \| null`              | Tooltip/label shown when disabled.                 |
| `customContent`     | `ReactNode \| null`           | Custom body content instead of default.            |
| `primaryIcon`       | `ElementType \| null`         | Leading icon component.                            |
| `secondaryIcon`     | `ElementType \| null`         | Optional trailing icon component.                  |
| `onClick`           | `(() => void) \| null`        | Click handler for interactive tiles.               |
| `ariaLabel`         | `string`                      | Accessibility label (required for a11y).           |
| `isLoading`         | `boolean`                     | Shows skeleton state.                              |
| `isDisabled`        | `boolean`                     | Disables interactions and applies disabled styles. |

##### AIPromptTile (`variant: 'aiPrompt'`)

| Prop                | Type                          | Notes                                                 |
| ------------------- | ----------------------------- | ----------------------------------------------------- |
| `tileId`            | `string \| null`              | Identifier (recommended non-null in configs).         |
| `href`              | `string \| null`              | Destination for ‚ÄúOpen [product]‚Äù.                     |
| `title`             | `string \| ReactNode \| null` | Heading text.                                         |
| `disabledTaskLabel` | `string \| null`              | Tooltip/label shown when disabled.                    |
| `productName`       | `string`                      | Used in labels (e.g., ‚ÄúOpen [product]‚Äù, button text). |
| `promptPlaceholder` | `string`                      | Placeholder for the chat input.                       |
| `primaryIcon`       | `ElementType \| null`         | Leading icon component.                               |
| `onClick`           | `(() => void) \| null`        | Click handler for interactive tiles.                  |
| `ariaLabel`         | `string`                      | Accessibility label (required for a11y).              |
| `isLoading`         | `boolean`                     | Shows skeleton state.                                 |
| `isDisabled`        | `boolean`                     | Disables interactions and applies disabled styles.    |

> Note: AIPromptTile handles text input internally and can optionally call your
> `onSubmit` in your product integration (if you wire it), but the core public
> props above are what's typically used in `AnimatedHeader`.

---

#### Migration Guide

- Replace `id` ‚Üí `tileId`
- Replace `mainIcon` ‚Üí `primaryIcon`
- Use `variant` to explicitly pick the tile type
- Ensure every tile defines `tileId`
- Add `ariaLabel` to every tile for accessibility

Example migration:

```diff
- {
-   id: 'ai-tile',
-   title: 'Short description of the type of prompt',
-   mainIcon: Term
- }
+ {
+   tileId: 'tile-1',
+   variant: 'aiPrompt',
+   title: 'Short description of the type of prompt',
+   primaryIcon: Term
+ }
```

### Accessibility

To ensure a fully accessible experience, provide `aria-label`s directly in your
tile and configuration data.

#### Tile ARIA Labels

Each `Tile` must define an `ariaLabel` property directly within its data object.
This ensures accessibility information is co-located with the tile configuration
and is easier to maintain.

```jsx
import { type TileGroup } from '@carbon-labs/react-animated-header';

export const headerTiles: TileGroup[] = [
  {
    id: 1,
    label: 'AI Prompt Tile w/ two glass tiles',
    tiles: [
      {
        tileId: 'tile-1',
        variant: 'aiPrompt',
        href: '#',
        title: 'Short description of the type of prompt',
        primaryIcon: Term,
        ariaLabel: 'Start a conversation with the AI assistant', // ‚úÖ aria-label defined here
      },
    ],
  },
] satisfies TileGroup[];
```

#### Tasks Dropdown ARIA Label

For the tasks controller dropdown, provide the `ariaLabel` directly in the
config object:

```jsx
export const tasksControllerConfigDropdown = {
  type: 'dropdown',
  dropdown: {
    label: 'Customize your journey',
    allTileGroups: headerTiles,
    selectedTileGroup: headerTiles[0],
    setSelectedTileGroup: () => {},
    ariaLabel: 'Select a task group', // ‚úÖ aria-label defined here
  },
};
```

#### Workspace Selector ARIA Label

For the workspace selector, define the `ariaLabel` at the top level of the
config object:

```jsx
export const workspaceSelectorConfig = {
  allWorkspaces: workspaceData,
  setSelectedWorkspace: () => {},
  propsOverrides: {
    label: 'Select workspace',
    renderSelectedItem: (item) => `Open in: ${item.label}`,
  },
  ariaLabel: 'Select a workspace', // ‚úÖ aria-label defined here
};
```

> ‚úÖ Both the **tasks dropdown** and **workspace selector** must define their
> `aria-label` values in the config to support accessibility. No other methods
> of passing `aria-label`s are supported.

---

#### Additional ARIA Labels

Set all other component-level `aria-label`s using the `ariaLabels` prop:

```jsx
const ariaLabels = {
  welcome: 'Welcomes the user',
  description: 'Short description of the product',
  collapseButton: 'Collapse header details',
  expandButton: 'Expand header details',
  tilesContainer: 'Feature tiles list',
};
```

These labels are applied to non-tile UI elements such as headers, containers,
and interactive buttons.

## Getting started

Here's a quick example to get you started.

```bash
yarn add @carbon/react
yarn add @carbon-labs/react-animated-header
```

### JS (via import)

```jsx
import { AnimatedHeader } from '@carbon-labs/react-animated-header';

function App() {
  return <AnimatedHeader />;
}

export default App;
```

### SCSS

In your styles file import

```scss
@use '@carbon/react';
@use '@carbon-labs/react-animated-header/scss/animated-header';
```

## Component API

<ArgTypes />

## Example usages

Example of Animated Header with all prop types enabled.

```jsx
<AnimatedHeader
  productName="[Product name]"
  description="Connect, monitor, and manage data."
  welcomeText="Welcome"
  userName="Drew"
  ariaLabels={ariaLabelsConfig as AriaLabels}
  headerAnimation={watsonXAnimatedLight}
  headerStatic={watsonXStaticLight}
  allTileGroups={tiles}
  selectedTileGroup={selectedTile}
  workspaceSelectorConfig={workspaceSelectorConfig}
  tasksControllerConfig={tasksControllerConfigDropdown as TasksControllerConfig}
  isLoading={false}
  tileClickHandler={handleTileClicks}
/>
```
