import{n as d,t as P}from"./property-B7qFMDfR.js";import{i as E,c as A,b as s}from"./iframe-DJhAwP_w.js";import{r as x}from"./state-ro6c5RWN.js";import{o as tt}from"./unsafe-html-FTAKsixo.js";import{_ as H}from"./16-D0aIqdwb.js";import"./operational-tag-EJBIytvR.js";import{_ as et}from"./16-BpKA4nzT.js";import"./button-X5hvQSVc.js";import"./button-skeleton-BeRZ0qnV.js";import{i as l}from"./icon-loader-DIBBKQSJ.js";import{s as k}from"./settings-BQP9c3yA.js";import{_ as it}from"./search-BmFEao0l.js";import{_ as at}from"./16-CQhU3uUy.js";import"./tableElement-D0nVmKlr.js";const st=E`@keyframes fade-in{0%{opacity:0}to{opacity:1}}:host(clabs-chat-card) .clabs--chat-card-container{display:flex;overflow:hidden;box-sizing:border-box;flex-direction:row;padding:0;border:1px solid var(--cds-border-subtle-00, #e0e0e0);border-radius:8px;animation:fade-in .6s forwards;background:var(--cds-background, #ffffff);inline-size:248px;opacity:0;transition:border-color .15s linear}:host(clabs-chat-card) .clabs--chat-card-container:hover{border:1px solid var(--cds-focus, #0f62fe)}:host(clabs-chat-card) .clabs--chat-card-detail-side-icon{display:flex;box-sizing:border-box;justify-content:center;padding-inline-end:8px}:host(clabs-chat-card) .clabs--chat-card-main-content{display:flex;overflow:hidden;box-sizing:border-box;flex-direction:column;flex-grow:1}:host(clabs-chat-card) .clabs--chat-card-image-container{overflow:hidden;background:var(--cds-background, #ffffff);block-size:124px;inline-size:248px}:host(clabs-chat-card) .clabs--chat-card-image-container img{overflow:hidden;background:#d0e2ff;block-size:auto;inline-size:100%;min-block-size:124px}:host(clabs-chat-card) .clabs--chat-card-detail-container{display:flex;overflow:hidden;box-sizing:border-box;flex-direction:row;padding:16px;block-size:124px;gap:4px;inline-size:100%}:host(clabs-chat-card) .clabs--chat-card-detail-container-video{display:flex;overflow:hidden;box-sizing:border-box;flex-direction:row;padding:16px;block-size:86px;gap:4px;inline-size:100%}:host(clabs-chat-card) .clabs--chat-card-detail-side-content{display:flex;overflow:hidden;box-sizing:border-box;flex-direction:column;block-size:92px;gap:4px;inline-size:100%}:host(clabs-chat-card) .clabs--chat-card-detail-side-content-video{display:flex;overflow:hidden;box-sizing:border-box;flex-direction:column;block-size:54px;gap:4px;inline-size:100%}:host(clabs-chat-card) .clabs--chat-card-video-container{display:flex;overflow:hidden;align-items:center;justify-content:center;background:#000;block-size:164px;inline-size:248px}:host(clabs-chat-card) .clabs--chat-card-video-container video{overflow:hidden;block-size:auto;inline-size:100%;max-block-size:164px}:host(clabs-chat-card) .clabs--chat-card-detail-title{position:relative;overflow:hidden;block-size:22px;color:var(--cds-text-primary, #161616);font-family:IBM Plex Sans,sans-serif;font-size:16px;font-style:normal;font-weight:500;line-height:22px;white-space:nowrap}:host(clabs-chat-card) .clabs--chat-card-detail-title:after{position:absolute;z-index:99;background:linear-gradient(to right,var(--chat-card-theme-bottom, "rgba(0,0,0,0)"),var(--chat-card-theme-top, "rgba(0,0,0,0)"));block-size:100%;content:"";inline-size:30px;inset-block-start:0;inset-inline-end:0;pointer-events:none}:host(clabs-chat-card) .clabs--chat-card-detail-description{position:relative;overflow:hidden;box-sizing:border-box;flex-grow:1;color:var(--cds-text-secondary, #525252);font-size:12px;line-height:16px;white-space:nowrap}:host(clabs-chat-card) .clabs--chat-card-detail-description:after{position:absolute;z-index:99;background:linear-gradient(to right,var(--chat-card-theme-bottom, "rgba(0,0,0,0)"),var(--chat-card-theme-top, "rgba(0,0,0,0)"));block-size:100%;content:"";inline-size:30px;inset-block-start:0;inset-inline-end:0;pointer-events:none}:host(clabs-chat-card) .clabs--chat-card-loader{flex-grow:2;background-color:#d0e2ff;block-size:248px}:host(clabs-chat-card) .clabs--chat-card-loader-file{flex-grow:2;background-color:#d0e2ff;block-size:124px}:host(clabs-chat-card) .clabs--chat-card-detail-link-container{display:flex;align-items:center;justify-content:space-between;block-size:16px;font-size:12px}:host(clabs-chat-card) .clabs--chat-card-detail-link{color:var(--cds-link-primary, #0f62fe);text-decoration:none;white-space:nowrap}:host(clabs-chat-card) .clabs--chat-card-detail-link a{color:var(--cds-link-primary, #0f62fe);text-decoration:none}:host(clabs-chat-card) .clabs--chat-card-detail-link-icon{color:var(--cds-link-primary, #0f62fe)}:host(clabs-chat-card) .clabs--chat-card-detail-link-icon svg{fill:var(--cds-link-primary, #0f62fe)}:host(clabs-chat-card) .clabs--chat-card-detail-audio-container{display:flex;box-sizing:border-box;flex-grow:1;align-items:center}:host(clabs-chat-card) .clabs--chat-card-detail-audio-item{color:var(--cds-text-secondary, #525252);font-size:10px}:host(clabs-chat-card) .clabs--chat-card-detail-audio-timer{color:var(--cds-text-secondary, #525252);font-size:10px;padding-inline:8px 9px}:host(clabs-chat-card) .clabs--chat-card-detail-audio-progress-bar{position:relative;box-sizing:border-box;flex-grow:1;border-radius:2px;background:var(--cds-border-subtle-01, #c6c6c6);block-size:4px}:host(clabs-chat-card) .clabs--chat-card-detail-audio-progress{background:var(--cds-link-primary, #0f62fe);block-size:4px;inline-size:var("--chat-card-audio-progress-bar-width", "0%")}`;var nt=Object.defineProperty,$=(c,t,e,a)=>{for(var i=void 0,n=c.length-1,o;n>=0;n--)(o=c[n])&&(i=o(t,e,i)||i);return i&&nt(t,e,i),i};const L=class L extends A{constructor(){super(...arguments),this.fileTypes=["csv","mp3","mp4","png","pdf","ppt","svg","xls","zip","wmv","txt","tsv","mov","jpg","gif"],this._cardData=null,this._isAudioPlaying=!1}firstUpdated(){this._getTheme(),this._buildCard()}updated(t){t.has("content")&&this._buildCard(),(t.has("_audioProgress")||t.has("_audioDuration"))&&this.style.setProperty("--chat-card-audio-progress-bar-width",this._audioProgress/this._audioDuration*100+"%")}_translateHexToRGB(t){const e=t.replace(/^#/,""),a=parseInt(e.substring(0,2),16),i=parseInt(e.substring(2,4),16),n=parseInt(e.substring(4,6),16);return[a,i,n].join(",")}_getTheme(){if(this.parentElement instanceof HTMLElement){const e=getComputedStyle(this.parentElement).getPropertyValue("--cds-background"),a=this._translateHexToRGB(e);this.style.setProperty("--chat-card-theme-bottom"," rgba("+a+", 0)"),this.style.setProperty("--chat-card-theme-top"," rgba("+a+", 1)")}}_buildCard(){this.cardElements==null?this.type==="file"?this._getFileData(this.content):this.type==="audio"?this._getAudioData(this.content):this.loading||this._getSitePreviewData(this.content):(this._cardData=this.cardElements,this.fileType==null&&this.type!=="url"&&(this.fileType=this._getFileType(this.cardElements.link)),this.requestUpdate())}_getShortenedURL(t){try{return new URL(t).host}catch{return""}}_getSiteName(t){try{const e=new URL(t),a=e.hostname.replace(/^www\./,"").split(".").slice(-2,-1)[0],i=a.charAt(0).toUpperCase()+a.slice(1),p=e.pathname.split("/").sort((m,v)=>v.length-m.length).pop(),u=p?p.replace(new RegExp("[-_]+","g")," "):"";return u!==""?i+": "+u.charAt(0).toUpperCase()+u.slice(1):i}catch{return""}}_getVideoFileName(t){try{return t.split("/").slice(-1)[0]}catch{return""}}_getVideoTitle(t){try{return t.split("/").slice(-1)[0].split(".")[0].replace(/_/g," ")}catch{return""}}_getFileType(t){const e=t.split(".");let a=e[e.length-1];return this.fileTypes.indexOf(a)<0&&(a="unknown"),a}_getFileData(t){const e={};e.title=t.split("/").slice(-1),e.shortenedUrl=this._getShortenedURL(t),e.link=t,this.fileType=this._getFileType(t),e.description=this.fileType+" file from: "+t,this._cardData=e,this.requestUpdate()}_getAudioData(t){const e={};e.title=this._getVideoTitle(t),e.shortenedUrl=this._getShortenedURL(t),e.link=t,this.fileType=this._getFileType(t),e.description=this.fileType!=="unknown"?this.fileType.toUpperCase():" file from: "+t,this._cardData=e,this._updateAudioDuration(),this._updateAudioProgress(),this.requestUpdate()}_toggleAudio(){var e;const t=(e=this.shadowRoot)==null?void 0:e.querySelector("audio");t instanceof HTMLElement&&(t.paused?(t.play(),this._isAudioPlaying=!0):(t.pause(),this._isAudioPlaying=!1))}_updateAudioDuration(){var e;const t=(e=this.shadowRoot)==null?void 0:e.querySelector("audio");t instanceof HTMLElement&&(this._audioDuration=t.duration),this._updateAudioProgress()}_updateAudioProgress(){var e;const t=(e=this.shadowRoot)==null?void 0:e.querySelector("audio");t instanceof HTMLElement&&(this._audioProgress=t.currentTime)}_formatAudioTime(t){if(!t)return"00:00";const e=Math.floor(t/60);let a=e.toString();e<10&&(a="0"+a);const i=Math.floor(t%60);let n=i.toString();return i<10&&(n="0"+n),a+":"+n}async _getSitePreviewData(t){try{let e={};this.apiUrl&&(e=await this._previewData(t)),(!e||!e.title&&!e.imageUrl&&!e.description)&&(this.type==="video"?e.title=this._getVideoTitle(t):(e.title=this._getSiteName(t),e.description=t)),e.title||(e.title=this._getSiteName(t)),e.link||(e.link=t),e.shortenedUrl=this._getShortenedURL(t),this._cardData=e,this.requestUpdate()}catch{const a=this._getSiteName(t);this._cardData={title:a,imageUrl:null,description:t,link:t},this.requestUpdate()}}async _previewData(t){const e=this.apiUrl,a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:t})};try{return await fetch(e,a).then(i=>i.json()).then(i=>i)}catch(i){return{reply:"Error reaching: "+e+" Details: "+i.message,failed:!0}}}};L.styles=st;let _=L;$([d({type:Object,attribute:"card-elements",reflect:!0})],_.prototype,"cardElements");$([x()],_.prototype,"fileTypes");$([d({type:String,attribute:"content",reflect:!0})],_.prototype,"content");$([d({type:String,attribute:"api-url",reflect:!0})],_.prototype,"apiUrl");$([d({type:String,attribute:"type",reflect:!0})],_.prototype,"type");$([d({type:String,attribute:"file-type",reflect:!0})],_.prototype,"fileType");$([d({type:Boolean,attribute:"loading",reflect:!0})],_.prototype,"loading");$([x()],_.prototype,"_cardData");$([x()],_.prototype,"_isAudioPlaying");$([x()],_.prototype,"_audioProgress");$([x()],_.prototype,"_audioDuration");$([x()],_.prototype,"_audioRatio");var O={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M8,1C4.1,1,1,4.1,1,8s3.1,7,7,7s7-3.1,7-7S11.9,1,8,1z M11.7,8.4l-5.5,3c-0.2,0.1-0.3,0.1-0.5,0c-0.2-0.1-0.2-0.3-0.2-0.4V5	c0-0.2,0.1-0.3,0.2-0.4c0.2-0.1,0.3-0.1,0.5,0l5.5,3C12,7.7,12.1,8,11.9,8.2C11.9,8.3,11.8,8.4,11.7,8.4L11.7,8.4z"}}],name:"play--filled",size:16},N={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M12,6H10A2,2,0,0,0,8,8V24a2,2,0,0,0,2,2h2a2,2,0,0,0,2-2V8a2,2,0,0,0-2-2Z"}},{elem:"path",attrs:{d:"M22,6H20a2,2,0,0,0-2,2V24a2,2,0,0,0,2,2h2a2,2,0,0,0,2-2V8a2,2,0,0,0-2-2Z"}}],name:"pause--filled",size:16},ot={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M31 12.41 29.59 11 26 14.59 22.41 11 21 12.41 24.59 16 21 19.59 22.41 21 26 17.41 29.59 21 31 19.59 27.41 16 31 12.41z"}},{elem:"path",attrs:{d:"M18,30a1,1,0,0,1-.71-.3L9.67,22H3a1,1,0,0,1-1-1H2V11a1,1,0,0,1,1-1H9.67l7.62-7.7a1,1,0,0,1,1.41,0A1,1,0,0,1,19,3V29A1,1,0,0,1,18,30ZM4,20h6a1.17,1.17,0,0,1,.79.3L17,26.57V5.43L10.79,11.7A1.17,1.17,0,0,1,10,12H4Z"}}],name:"volume--mute",size:16},j={},rt={},lt={},ct={},dt={},ht={},pt={},ut={},B={},bt={},ft={},xt={},mt={},gt={},vt={},F={},V={},q={};/**
 * @license
 *
 * Copyright IBM Corp. 2023
 *
 * This source code is licensed under the Apache-2.0 license found in the
 * LICENSE file in the root directory of this source tree.
 */const{stablePrefix:r}=k;function _t(c){const{_cardData:t,type:e,content:a,fileType:i,_toggleAudio:n,_isAudioPlaying:o,_audioProgress:p,_audioDuration:u,_updateAudioDuration:m,_updateAudioProgress:v,_formatAudioTime:z}=c;return s`<div class="${r}--chat-card-container">
    <div class="${r}--chat-card-main-content">
      ${t?s` ${t.imageUrl&&e==="url"?s` <div class="${r}--chat-card-image-container">
                  <img
                    class="${r}--chat-card-image"
                    src="${t.imageUrl}" />
                </div>`:e==="video"?s` <div class="${r}--chat-card-video-container">
                  <video controls>
                    <source src="${a}" type="video/webm" />
                  </video>
                </div>`:s``}

            <div
              class="${r}--chat-card-detail-container${e==="video"?"-video":""}">
              ${i&&e==="file"?s` <div class="${r}--chat-card-detail-side-icon">
                    ${i==="mp3"?s`${l(j())}`:i==="mp4"?s`${l(rt())}`:i==="png"?s`${l(lt())}`:i==="pdf"?s`${l(ct())}`:i==="ppt"?s`${l(dt())}`:i==="svg"?s`${l(ht())}`:i==="xls"?s`${l(pt())}`:i==="zip"?s`${l(ut())}`:i==="wmv"?s`${l(B())}`:i==="txt"?s`${l(bt())}`:i==="tsv"?s`${l(ft())}`:i==="mov"?s`${l(xt())}`:i==="jpg"?s`${l(mt())}`:i==="gif"?s`${l(gt())}`:i==="csv"?s`${l(vt())}`:s`${l(V())}`}
                  </div>`:s``}
              ${e==="video"?s` <div class="${r}--chat-card-detail-side-icon">
                    ${l(F())}
                  </div>`:s``}
              ${i&&e==="audio"?s`
                    ${i!=="unknown"?s` <div
                          class="${r}--chat-card-detail-side-icon">
                          ${i==="mp3"?s`${l(j())}`:i==="wmv"?s`${l(B())}`:s`${l(q())}`}
                        </div>`:s``}
                  `:s``}

              <div
                class="${r}--chat-card-detail-side-content${e==="video"?"-video":""}">
                <div class="${r}--chat-card-detail-title">
                  ${t.title}
                </div>

                <div class="${r}--chat-card-detail-description">
                  ${t.description?t.description:""}
                </div>
                ${e!=="audio"?s`
                      <div
                        class="${r}--chat-card-detail-link-container">
                        <a
                          class="${r}--chat-card-detail-link"
                          href="${t.link}"
                          target="_blank"
                          >${t.shortenedUrl}</a
                        >

                        <div class="${r}--chat-card-detail-link-icon">
                          <a href="${t.link}" target="_blank">
                            ${l(et())}
                          </a>
                        </div>
                      </div>
                    `:s`
                      <div
                        class="${r}--chat-card-detail-audio-container">
                        <div
                          class="${r}--chat-card-detail-audio-item">
                          ${o?s` <cds-button
                                aria-label="Pause Audio File"
                                role="button"
                                kind="ghost"
                                size="sm"
                                @click="${n}">
                                ${l(N,{slot:"icon"})}
                              </cds-button>`:s` <cds-button
                                kind="ghost"
                                aria-label="Play Audio File"
                                role="button"
                                size="sm"
                                @click="${n}">
                                ${l(O,{slot:"icon"})}
                              </cds-button>`}
                        </div>
                        <!-- <div class="${r}--chat-card-detail-audio-item">
                <cds-button aria-label="Mute Audio" role="button" kind="ghost" size="sm" disabled>
                  ${l(ot,{slot:"icon"})}
                </cds-button>
                </div>-->
                        <div
                          class="${r}--chat-card-detail-audio-progress-bar">
                          <div
                            class="${r}--chat-card-detail-audio-progress">
                            &nbsp;
                          </div>
                        </div>
                        <div
                          class="${r}--chat-card-detail-audio-timer">
                          ${z(p)}/${z(u)}
                        </div>
                      </div>
                      <audio
                        id="audio"
                        src="${t.link}"
                        @timeupdate="${v}"
                        @loadedmetadata="${m}"></audio>
                    `}
              </div>
            </div>`:s`${e==="url"?s` <div
                  class="${r}--chat-card-image-container"></div>`:e==="video"?s` <div
                  class="${r}--chat-card-video-container"></div>`:s``}

            <div
              class="${r}--chat-card-detail-container${e==="video"?"-video":""}">
              ${e==="file"?s` <div class="${r}--chat-card-detail-side-icon">
                    ${l(V())}
                  </div>`:s``}
              ${e==="video"?s` <div class="${r}--chat-card-detail-side-icon">
                    ${l(F())}
                  </div>`:s``}
              ${e==="audio"?s` <div class="${r}--chat-card-detail-side-icon">
                    ${l(q())}
                  </div>`:s``}

              <div
                class="${r}--chat-card-detail-side-content${e==="video"?"-video":""}">
                <div class="${r}--chat-card-detail-title">&nbsp;</div>

                <div class="${r}--chat-card-detail-description">
                  &nbsp;
                </div>
                ${e!=="audio"?s`
                      <div
                        class="${r}--chat-card-detail-link-container">
                        <div
                          class="${r}--chat-card-detail-link-icon"></div>
                      </div>
                    `:s`
                      <div
                        class="${r}--chat-card-detail-audio-container">
                        <div
                          class="${r}--chat-card-detail-audio-item">
                          ${o?s` <cds-button
                                aria-label="Pause Audio"
                                role="button"
                                kind="ghost"
                                disabled
                                size="sm">
                                ${l(N,{slot:"icon"})}
                              </cds-button>`:s` <cds-button
                                aria-label="Start Audio"
                                role="button"
                                kind="ghost"
                                disabled
                                size="sm">
                                ${l(O,{slot:"icon"})}
                              </cds-button>`}
                        </div>
                        <div
                          class="${r}--chat-card-detail-audio-progress-bar">
                          <div
                            class="${r}--chat-card-detail-audio-progress">
                            &nbsp;
                          </div>
                        </div>
                        <div
                          class="${r}--chat-card-detail-audio-timer">
                          00:00/00:00
                        </div>
                      </div>
                    `}
              </div>
            </div>`}
    </div>
  </div>`}var yt=Object.getOwnPropertyDescriptor,$t=(c,t,e,a)=>{for(var i=a>1?void 0:a?yt(t,e):t,n=c.length-1,o;n>=0;n--)(o=c[n])&&(i=o(i)||i);return i};const{stablePrefix:wt}=k;let W=class extends _{render(){return _t(this)}};W=$t([P(`${wt}-chat-card`)],W);const St=E`:host(clabs-chat-text){overflow:hidden;font-family:IBM Plex Sans,sans-serif;font-size:14px;font-style:normal;font-weight:400;letter-spacing:.16px;line-height:20px;word-break:break-word}:host(clabs-chat-text) .clabs--chat-text--float-right{display:flex;justify-content:flex-end}:host(clabs-chat-text) .clabs--chat-text-content{flex-grow:1;max-inline-size:100%}:host(clabs-chat-text) .clabs--chat-text-content-chevron-container{display:inline-block}:host(clabs-chat-text) .clabs--chat-text-content-paragraph{margin:0}:host(clabs-chat-text) .clabs--chat-text-content-chevron{display:inline-block;box-sizing:border-box;padding:0;border:1px solid var(--cds-border-subtle-01, #c6c6c6);border-radius:8px;margin:0;background:var(--cds-layer-accent-01, #e0e0e0);block-size:16px;cursor:pointer;inline-size:18px;margin-inline:1px;transition:border-color .15s linear;vertical-align:middle}@keyframes fade-in{0%{opacity:0}to{opacity:1}}:host(clabs-chat-text) .clabs--chat-text-fade-in{animation:fade-in .6s forwards;opacity:0}:host(clabs-chat-text) .clabs--chat-text-content-chevron:hover{border:1px solid var(--cds-focus, #0f62fe);cursor:pointer}:host(clabs-chat-text) .clabs--chat-text-content-chevron--focused{border:1px solid var(--cds-focus, #0f62fe)}:host(clabs-chat-text) .clabs--chat-text-content-chevron svg{fill:var(--cds-text-secondary, #525252);pointer-events:none}:host(clabs-chat-text) .clabs--chat-text-content-annotation{cursor:pointer;text-decoration:underline;text-decoration-color:var(--cds-text-secondary, #525252);text-decoration-style:dotted;text-decoration-thickness:2px;text-underline-offset:3px;vertical-align:bottom}:host(clabs-chat-text) .clabs--chat-text-highlighted{background:var(--chat-text-element-highlight-color, var(--cds-link-inverse, #78a9ff));text-decoration:none}:host(clabs-chat-text) .clabs--chat-text-highlighted-active{background:var(--chat-text-element-highlight-color, var(--cds-link-inverse-hover, #a6c8ff))}:host(clabs-chat-text) .clabs--chat-text-content-annotation-element{overflow:hidden;inline-size:100%;max-block-size:var(--chat-text-content-annotation-element-height);max-inline-size:100%;padding-block:8px;transition:max-height .3s linear}:host(clabs-chat-text) .clabs--chat-text-content-summarization-element{overflow:hidden;inline-size:100%;max-block-size:var(--chat-text-content-annotation-element-height);max-inline-size:100%;padding-block:8px;transition:max-height .3s linear}:host(clabs-chat-text) .clabs--chat-text-content-summarization-element-hidden{display:none}:host(clabs-chat-text) .clabs--chat-text-content-link{cursor:pointer;text-decoration:underline;text-decoration-color:var(--cds-text-secondary, #525252);text-decoration-style:dotted;text-decoration-thickness:2px;text-underline-offset:3px;vertical-align:bottom}:host(clabs-chat-text) .clabs--chat-text-content-code{border:1px solid var(--cds-border-subtle-01, #c6c6c6);border-radius:4px;background:var(--cds-layer-01, #f4f4f4);color:var(--cds-text-primary, #161616);font-family:IBM Plex Mono,monospace;font-size:12px;letter-spacing:.64px;line-height:20px;vertical-align:bottom;word-break:keep-all}:host(clabs-chat-text) .clabs--chat-text--float-left{display:flex;justify-content:flex-start}`;var kt=Object.defineProperty,b=(c,t,e,a)=>{for(var i=void 0,n=c.length-1,o;n>=0;n--)(o=c[n])&&(i=o(t,e,i)||i);return i&&kt(t,e,i),i};const U=class U extends A{constructor(){super(...arguments),this.enableHtmlRendering=!1,this.disableNewLines=!1,this._textElements=[],this.textSubElements=[],this._showSummarization=!1,this._translationRegistry=[],this._animationList=[]}firstUpdated(){var t;((t=this.textSubElements)==null?void 0:t.length)>1?this._textElements=this.textSubElements:this.content&&this._formatText(),this.hasAttribute("enable-summarization")&&(this.disableChevrons=!0),this.hasAttribute("text-highlight-color")&&this.style.setProperty("--chat-text-element-highlight-color",this.textHighlightColor),this.style.setProperty("--chat-text-content-annotation-element-height","0px")}updated(t){super.updated(t),t.has("content")&&!(this.textSubElements.length>0)&&this._formatText()}_updateHighlightTarget(t){var a;const e=(a=t==null?void 0:t.detail)==null?void 0:a.currentIndex;if(e>=0){const i=this._translationRegistry.find(n=>n.annotationIndex===e+1);if(this._textElements.forEach(n=>{n.active=!1}),i||i===0){const n=i.subElementIndex;typeof n=="number"&&(this._textElements[n-1].active=!0)}this.requestUpdate()}}_toggleSummarization(){if(this._showSummarization=!this._showSummarization,!this._showSummarization)this._textElements.forEach(t=>{t.active=!1});else{this.selectedAnnotationIndex||(this.selectedAnnotationIndex=0);const t=this.selectedAnnotationIndex+1,e=this._translationRegistry.find(a=>a.annotationIndex===t);if(e){const a=e.subElementIndex;typeof a=="number"&&(this._textElements[a-1].active=!0,setTimeout(()=>{this.style.setProperty("--chat-text-content-annotation-element-height","400px")},20))}}}_handleAnnotationClick(t){var p,u;const e=(t==null?void 0:t.originalTarget)||(t==null?void 0:t.target)||(t==null?void 0:t.srcElement),a=(p=e==null?void 0:e.dataset)==null?void 0:p.source;this.style.setProperty("--chat-text-content-annotation-element-height","0px");const i=(u=e==null?void 0:e.dataset)==null?void 0:u.index,n={originalEvent:t,annotationContent:a,indexInElementsArray:i,elementsArray:this._textElements};if(i){this._textElements.forEach((v,z)=>{z!==parseInt(i)&&(v.active=!1)}),this._textElements[parseInt(i)].active=!this._textElements[parseInt(i)].active,this._textElements[parseInt(i)].active?(n.action="annotation popup closed",this._showSummarization=!0):(n.action="annotation popup opened",this._showSummarization=!1),n.isOpened=this._textElements[parseInt(i)].active,n.textContent=this._textElements[parseInt(i)].text,this._textElements[parseInt(i)].active?a?(this._annotationURLs=this._arrangeSources(a),setTimeout(()=>{this.style.setProperty("--chat-text-content-annotation-element-height","400px")},20),this._annotationIndex=parseInt(i)):(this._annotationURLs=null,this._annotationIndex=null):(this._annotationURLs=null,this._annotationIndex=null);const m=this._translationRegistry.find(v=>v.subElementIndex===parseInt(i)+1);typeof(m==null?void 0:m.annotationIndex)=="number"&&m&&(this.selectedAnnotationIndex=m.annotationIndex-1,this.requestUpdate())}const o=new CustomEvent("on-text-annotation-click",{detail:n,bubbles:!0,composed:!0});this.dispatchEvent(o)}_arrangeSources(t){return t.split(",")}_capitalizeText(t){return t.split(new RegExp("(?<=[.!?]\\s)|(?<=\\n)","g")).map(i=>i.trimStart().charAt(0).toUpperCase()+i.trimStart().slice(1)).join("")}_formatText(){const t=new RegExp("(\\[([^\\]]+)\\]\\(([^)]+)\\))|([^\\[]+)","g"),e=[],a=[];let i;const o=this.content.trim().split(`
`);for(const p of o){for(;(i=t.exec(p))!=null;)if(i[1])a.push({text:i[2],type:"annotation",content:i[3],active:!1}),e.push(i[3]),this._translationRegistry.push({annotationIndex:e.length,subElementIndex:a.length});else if(i[4]){const m=this._checkForHTML(i[4])?"html":"default",v=i[4];a.push({text:this.capitalize?this._capitalizeText(v):v,type:m,active:!1,content:""})}if(!this.disableNewLines&&!this.streaming){if(a.length>1&&a[a.length-1]){const u=a[a.length-1];if((u==null?void 0:u.type)==="new-line")continue}a.push({text:"",type:"new-line",active:!1,content:""})}}this._annotationList=e,this.streaming?this._animateFadeIn(a):(this._annotationList.length>0,this._textElements=a)}_animateFadeIn(t){const e=[];for(const a of t)if(a.type==="default"){const i=a.text.split(" ");for(const n of i)e.push({text:n+" ",type:"default",content:"",active:!1})}else e.push(a);this._textElements=e}_checkForHTML(t){return new RegExp("<[^>]+>","g").test(t)}_formatTextOld(){const t=[],e=new RegExp("\\[([^\\]]+)\\]\\(((?:[^)(]+|\\([^)]+\\))*)\\)","g"),a=this.content,i=this.disableNewLines?[a]:a.split(`
`);for(let n=0;n<i.length;n++){let o;const p=i[n];let u=0;for(;(o=e.exec(p))!==null;){if(o.index>u){const v=p.slice(u,o.index);t.push({text:this.capitalize?this._capitalizeText(v):v,type:"default",active:!1,content:""})}const m=new RegExp("^https?:\\/\\/\\S+$");t.push({text:o[1],type:m.test(o[2])?"link":"annotation",content:o[2],active:!1}),u=e.lastIndex}if(u<p.length){const m=p.slice(u);t.push({text:this.capitalize?this._capitalizeText(m):m,type:"default",content:"",active:!1})}}this._textElements=t}};U.styles=St;let h=U;b([d({type:String,attribute:"content",reflect:!0})],h.prototype,"content");b([d({type:Boolean,attribute:"align-right"})],h.prototype,"alignRight");b([d({type:Boolean,attribute:"capitalize"})],h.prototype,"capitalize");b([d({type:String,attribute:"text-highlight-color"})],h.prototype,"textHighlightColor");b([d({type:Boolean,attribute:"enable-annotations"})],h.prototype,"enableAnnotations");b([d({type:Boolean,attribute:"enable-summarization"})],h.prototype,"enableSummarization");b([d({type:Boolean,attribute:"enable-html-rendering"})],h.prototype,"enableHtmlRendering");b([d({type:Boolean,attribute:"enable-text-highlighting"})],h.prototype,"enableTextHighlighting");b([d({type:Boolean,attribute:"disable-new-lines"})],h.prototype,"disableNewLines");b([d({type:Boolean,attribute:"enable-complex-feedback"})],h.prototype,"enableComplexFeedback");b([d({type:Boolean,attribute:"disable-chevrons"})],h.prototype,"disableChevrons");b([x()],h.prototype,"_textElements");b([d({type:Array,attribute:"textSubElements"})],h.prototype,"textSubElements");b([x()],h.prototype,"_annotationURLs");b([x()],h.prototype,"_annotationList");b([x()],h.prototype,"_annotationIndex");b([x()],h.prototype,"_showSummarization");b([x()],h.prototype,"_translationRegistry");b([x()],h.prototype,"selectedAnnotationIndex");b([d({type:Boolean,attribute:"streaming"})],h.prototype,"streaming");b([x()],h.prototype,"_animationList");var G={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M8 5 13 10 12.3 10.7 8 6.4 3.7 10.7 3 10z"}}],name:"chevron--up",size:16};const zt=E`:host(clabs-chat-carousel){display:flex;overflow:hidden;background:none;inline-size:100%}:host(clabs-chat-carousel) .clabs--chat-carousel-container{display:flex;flex-direction:column;gap:6px;inline-size:var(--chat-carousel-slides-width, 248px)}:host(clabs-chat-carousel) .clabs--chat-carousel-length{block-size:16px;color:var(--cds-text-secondary, #525252);font-size:12px;padding-block-end:8px;text-align:start}:host(clabs-chat-carousel) .clabs--chat-carousel-slides{display:flex;overflow:hidden;flex-direction:row;flex-grow:1;gap:16px;min-block-size:0}:host(clabs-chat-carousel) .clabs--chat-carousel-slide{display:flex;overflow:hidden;flex:0 0 auto;align-items:center;justify-content:center;border-radius:8px;inline-size:248px}:host(clabs-chat-carousel) .clabs--chat-carousel-img{block-size:100%;inline-size:100%;object-fit:cover;object-position:center}:host(clabs-chat-carousel) .clabs--chat-carousel-controls{display:flex;align-items:center;justify-content:flex-end;block-size:32px;gap:8px;inline-size:100%}:host(clabs-chat-carousel) .clabs--chat-carousel-control-item{block-size:32px;font-size:14px;line-height:30px}:host(clabs-chat-carousel) .clabs--chat-carousel-control-item svg{color:var(--cds-text-secondary, #525252);fill:var(--cds-text-secondary, #525252)}`;var Ct=Object.defineProperty,w=(c,t,e,a)=>{for(var i=void 0,n=c.length-1,o;n>=0;n--)(o=c[n])&&(i=o(t,e,i)||i);return i&&Ct(t,e,i),i};const D=class D extends A{constructor(){super(...arguments),this.selectedSlide=0,this.contentWidth=248,this.contentHeight=248,this._itemsPerSlide=1,this._slideCounter=0,this._slideGapSize=16,this._maxSlideCounter=0,this._renderedSlideCounter=0}firstUpdated(){this.hasAttribute("elements")?(this._checkElements(),this._updateCarousel()):this.hasAttribute("content")&&this._buildCarousel(),this.hasAttribute("_carouselContent")&&this._updateCarousel(),this.resizeObserver=new ResizeObserver(async()=>{this._updateCarousel()}),this.resizeObserver.observe(this)}updated(t){super.updated(t),t.has("content")&&this._buildCarousel(),t.has("elements")&&this._checkElements(),t.has("contentWidth")&&this._buildCarousel(),t.has("_carouselContent")&&this._updateCarousel(),t.has("selectedSlide")&&this._carouselContent&&this._handleSlideSelection()}_updateCarousel(){if(this._carouselContent){if(this.parentElement instanceof HTMLElement){const e=this.clientWidth;this._itemsPerSlide=Math.max(Math.floor(e/(this.contentWidth+this._slideGapSize)),1),this.maxSlides&&(this._itemsPerSlide=Math.min(this._itemsPerSlide,this.maxSlides)),this.style.setProperty("--chat-carousel-slides-width",this._itemsPerSlide*(this.contentWidth+this._slideGapSize)+"px")}else this.style.setProperty("--chat-carousel-slides-width",this.contentWidth+"px");this._maxSlideCounter=Math.ceil(this._carouselContent.length/this._itemsPerSlide)-1;let t=Math.floor(this._slideCounter/this._itemsPerSlide)*this._itemsPerSlide;t=Math.min(t,this._carouselContent.length-this._itemsPerSlide),this._renderedSlideCounter=Math.ceil(t/this._itemsPerSlide)+1}}_checkElements(){this._carouselContent=this.elements.map(t=>({content:t.content,type:t.type?t.type:this._checkURLType(t.content)}))}_checkURLType(t){const e=new RegExp("\\.(png|jpg|jpeg|gif|svg|bmp|webp|ico|tiff|tif)$","i"),a=new RegExp("\\.(mp4|avi|flv|mkv|mov|webm|m4v|ogv)$","i"),i=new RegExp("\\.(pdf|doc|docx|csv|xls|xlsx|ppt|pptx|txt|rtf|xml|odt|zip|rar|tar|gz)$","i"),n=new RegExp("\\.(mp3|flac|wav|mpa|wma|midi|ogg)$","i");return e.test(t)?"img":a.test(t)?"video":n.test(t)?"audio":i.test(t)?"file":"url"}_buildCarousel(){try{const t=JSON.parse(this.content);this._carouselContent=t.map(e=>({content:e,type:this._checkURLType(e)}))}catch{if(this.content.endsWith(",")){const e=this.content.slice(0,-1)+"]";try{const a=JSON.parse(e);if(this._carouselContent||(this._carouselContent=[]),a.length>this._carouselContent.length){const i=a[a.length-1];this._carouselContent=[{content:i,type:this._checkURLType(i)},...this._carouselContent]}}catch{console.log("Carousel: failed to parse:"+(this.content.slice(0,-1)+"]"))}}}}_handleNextSlide(){this._slideCounter+this._itemsPerSlide<this._carouselContent.length&&(this._slideCounter+=this._itemsPerSlide),this._maxSlideCounter=Math.ceil(this._carouselContent.length/this._itemsPerSlide)-1,this._renderedSlideCounter=Math.floor(this._slideCounter/this._itemsPerSlide)+1,this._scrollSlideContainer(),this._notifyIndexChange()}_handlePreviousSlide(){this._slideCounter-this._itemsPerSlide>=0&&(this._slideCounter-=this._itemsPerSlide),this._maxSlideCounter=Math.ceil(this._carouselContent.length/this._itemsPerSlide)-1,this._renderedSlideCounter=Math.floor(this._slideCounter/this._itemsPerSlide)+1,this._scrollSlideContainer(),this._notifyIndexChange()}_handleSlideSelection(){this.selectedSlide>=0&&this.selectedSlide<=this._carouselContent.length&&(this._slideCounter=this.selectedSlide),this._renderedSlideCounter=Math.floor(this._slideCounter/this._itemsPerSlide)+1,this._scrollSlideContainer()}_notifyIndexChange(){const t=new CustomEvent("on-carousel-index-change",{detail:{action:"CAROUSEL: user changed the current slide",currentIndex:this._slideCounter},bubbles:!0,composed:!0});this.dispatchEvent(t)}_scrollSlideContainer(){var a;const t=(a=this.shadowRoot)==null?void 0:a.querySelector(".clabs--chat-carousel-slides"),e=this._slideCounter*(this.contentWidth+this._slideGapSize)*this._itemsPerSlide;setTimeout(function(){t==null||t.scrollTo({left:e,behavior:"smooth"})},100)}};D.styles=zt;let y=D;w([d({type:String,attribute:"content",reflect:!0})],y.prototype,"content");w([d({type:Object,attribute:"elements",reflect:!0})],y.prototype,"elements");w([d({type:Number,attribute:"max-slides"})],y.prototype,"maxSlides");w([d({type:Number,attribute:"selected-slide"})],y.prototype,"selectedSlide");w([d({type:String,attribute:"content-width",reflect:!0})],y.prototype,"contentWidth");w([d({type:String,attribute:"content-height",reflect:!0})],y.prototype,"contentHeight");w([x()],y.prototype,"_carouselContent");w([x()],y.prototype,"_itemsPerSlide");w([x()],y.prototype,"_slideCounter");w([x()],y.prototype,"_slideGapSize");w([x()],y.prototype,"_maxSlideCounter");w([x()],y.prototype,"_renderedSlideCounter");const Tt=E`:host(clabs-chat-image) .clabs--chat-image-container{display:flex;overflow:hidden}@keyframes fade-in{0%{opacity:0}to{opacity:1}}:host(clabs-chat-image) .clabs--chat-image-img{border-radius:8px;animation:fade-in .6s forwards;block-size:auto;max-inline-size:100%;object-fit:contain;opacity:0}`;var Pt=Object.defineProperty,Et=(c,t,e,a)=>{for(var i=void 0,n=c.length-1,o;n>=0;n--)(o=c[n])&&(i=o(t,e,i)||i);return i&&Pt(t,e,i),i};const M=class M extends A{updated(t){super.updated(t)}firstUpdated(){}};M.styles=Tt;let T=M;Et([d({type:String,attribute:"content",reflect:!0})],T.prototype,"content");/**
 * @license
 *
 * Copyright IBM Corp. 2024
 *
 * This source code is licensed under the Apache-2.0 license found in the
 * LICENSE file in the root directory of this source tree.
 */const{stablePrefix:J}=k;function At(c){const{content:t}=c;return s`<div class="${J}--chat-image-container">
    <img class="${J}--chat-image-img" src="${t}" />
  </div>`}var Rt=Object.getOwnPropertyDescriptor,It=(c,t,e,a)=>{for(var i=a>1?void 0:a?Rt(t,e):t,n=c.length-1,o;n>=0;n--)(o=c[n])&&(i=o(i)||i);return i};const{stablePrefix:Lt}=k;let Z=class extends T{render(){return At(this)}};Z=It([P(`${Lt}-chat-image`)],Z);/**
 * @license
 *
 * Copyright IBM Corp. 2024
 *
 * This source code is licensed under the Apache-2.0 license found in the
 * LICENSE file in the root directory of this source tree.
 */const{stablePrefix:S}=k;function Ut(c){const{_carouselContent:t,_slideCounter:e,_maxSlideCounter:a,_handlePreviousSlide:i,_handleNextSlide:n,_renderedSlideCounter:o}=c;return s`<div class="${S}--chat-carousel-container">
    ${t?s` <div class="${S}--chat-carousel-length">
            ${t.length}
            ${t.length===1?"item":"items"}
          </div>
          <div class="${S}--chat-carousel-slides">
            ${t.map(p=>p.type=="img"?s` <div class="${S}--chat-carousel-slide">
                    <clabs-chat-image content="${p.content}">
                    </clabs-chat-image>
                  </div>`:s`
                  <div class="${S}--chat-carousel-slide">
                    <clabs-chat-card content="${p.content}"" type="${p.type}">
                    </clabs-chat-card>
                  </div>
                `)}
          </div>
          <div class="${S}--chat-carousel-controls">
            ${a>1?s`
                  <div class="${S}--chat-carousel-control-item">
                    <cds-button
                      kind="ghost"
                      size="sm"
                      aria-label="Previous Slide"
                      role="button"
                      @click="${i}"
                      ?disabled="${e===0}">
                      ${l(at,{slot:"icon"})}
                    </cds-button>
                  </div>
                  <div class="${S}--chat-carousel-control-item">
                    ${o+" / "+a}
                  </div>
                  <div class="${S}--chat-carousel-control-item">
                    <cds-button
                      kind="ghost"
                      aria-label="Next slide"
                      role="button"
                      size="sm"
                      @click="${n}"
                      ?disabled="${o===a}">
                      ${l(it,{slot:"icon"})}
                    </cds-button>
                  </div>
                `:s``}
          </div>`:s``}
  </div>`}var Dt=Object.getOwnPropertyDescriptor,Mt=(c,t,e,a)=>{for(var i=a>1?void 0:a?Dt(t,e):t,n=c.length-1,o;n>=0;n--)(o=c[n])&&(i=o(i)||i);return i};const{stablePrefix:Ht}=k;let K=class extends y{render(){return Ut(this)}};K=Mt([P(`${Ht}-chat-carousel`)],K);/**
 * @license
 *
 * Copyright IBM Corp. 2024
 *
 * This source code is licensed under the Apache-2.0 license found in the
 * LICENSE file in the root directory of this source tree.
 */const{stablePrefix:f}=k;function Ot(c){const{_textElements:t,alignRight:e,enableHtmlRendering:a,enableSummarization:i,_updateHighlightTarget:n,_annotationURLs:o,_annotationIndex:p,_annotationList:u,_handleAnnotationClick:m,enableTextHighlighting:v,selectedAnnotationIndex:z,disableChevrons:X,_toggleSummarization:Y,streaming:R,_showSummarization:I}=c;return s`<div
    class="${f}--chat-text"
    role="textbox"
    aria-readonly="true"
    tabindex="0"
    aria-label="text block">
    <div
      class="${f}--chat-text--float-${e?"right":"left"}">
      <div class="${f}--chat-text-content">
        ${t.map((g,C)=>s` ${g.type==="annotation"||g.type==="link"?s`
                  <span
                    class="${f}--chat-text-content-${g.type} ${R?f+"--chat-text-fade-in":""} ${v?f+"--chat-text-highlighted"+(g.active?"-active":""):""} "
                    data-index="${C}"
                    data-source="${g.content}"
                    @click="${m}">
                    ${g.text}
                  </span>
                  ${X?s``:s`
                        <span
                          class="${f}--chat-text-content-chevron-container"
                          role="button"
                          aria-label="Show link as card below">
                          <span
                            class="${f}--chat-text-content-chevron ${C===p?f+"--chat-text-content-chevron--focused":""}"
                            data-index="${C}"
                            data-source="${g.content}"
                            @click="${m}">
                            ${g.active?s`
                                  ${l(G,{slot:"icon"})}
                                `:s`
                                  ${l(H,{slot:"icon"})}
                                `}
                          </span>
                        </span>
                      `}
                  ${C===p&&!i?s`
                        <slot name="custom-highlight-component">
                          <div
                            class="${f}--chat-text-content-annotation-element">
                            ${o.length>1?s`
                                  <clabs-chat-carousel
                                    content=${JSON.stringify(o)}>
                                  </clabs-chat-carousel>
                                `:s`
                                  <clabs-chat-card
                                    type="url"
                                    content="${o[0]}">
                                  </clabs-chat-card>
                                `}
                          </div>
                        </slot>
                      `:s``}
                `:e?s` <span
                  class="${R?f+"--chat-text-fade-in":""}">
                  ${g.text}</span
                >`:a||g.type==="html"?s` <span
                  class="${f}--chat-text-content-${g.type}"
                  >${tt(g.text)}</span
                >`:g.type==="new-line"?s`<br />`:g.type==="code"?s`
                  <span
                    class="${f}--chat-text-content-${g.type}"
                    >${g.text}</span
                  >
                `:g.type==="default"?s` <span
                  class="${R?f+"--chat-text-fade-in":""}"
                  >${g.text}</span
                >`:s`<p class="${f}--chat-text-content-paragraph">
                  ${g.text}
                </p>`}`)}
        ${i?s`
              <span class="${f}--chat-text-content-chevron-container">
                <span
                  class="${f}--chat-text-content-chevron ${I?f+"--chat-text-content-chevron--focused":""}"
                  @click="${Y}"
                  role="button"
                  aria-label="show all links as a carousel below">
                  ${I?s` ${l(G,{slot:"icon"})} `:s` ${l(H,{slot:"icon"})} `}
                </span>
              </span>
              <div
                class="${f}--chat-text-content-summarization-element ${I?"":f+"--chat-text-content-summarization-element-hidden"}">
                <slot name="custom-highlight-component">
                  <clabs-chat-carousel
                    selected-slide="${z}"
                    max-slides="${1}"
                    @on-carousel-index-change=${n}
                    content=${JSON.stringify(u)}>
                  </clabs-chat-carousel>
                </slot>
              </div>
            `:s``}
      </div>
    </div>
  </div>`}var Nt=Object.getOwnPropertyDescriptor,jt=(c,t,e,a)=>{for(var i=a>1?void 0:a?Nt(t,e):t,n=c.length-1,o;n>=0;n--)(o=c[n])&&(i=o(i)||i);return i};const{stablePrefix:Bt}=k;let Q=class extends h{render(){return Ot(this)}};Q=jt([P(`${Bt}-chat-text`)],Q);export{G as _,ct as a};
